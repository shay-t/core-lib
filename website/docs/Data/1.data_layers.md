---
id: data_layers
title: Data Layers
sidebar_label: Data Layers
---

`Service`, `DataAccess` are nothing more the a plain python classes.

Data Layers classes only provide basic task in mind 

```
Keep Data Flow with the SAME rules and architecture.
```

[For more information about Data Layers.](/docs/Why/article_layers)

### Data Layer

In this layer we will define all entities, migration, connectors, and mapping, this is the layer that defines low-level assets that are needed to connect to various data sources.

##### <project_dir>/data_layers/data/db/user.py

```python
import enum
from core_lib.data_layers.data.db.sqlalchemy.base import Base
from core_lib.data_layers.data.db.sqlalchemy.types.int_enum import IntEnum
from core_lib.data_layers.data.db.sqlalchemy.mixins.soft_delete_mixin import SoftDeleteMixin
from sqlalchemy import Column, Integer, VARCHAR


class User(SoftDeleteMixin, Base):
    __tablename__ = 'user'

    class Gender(enum.Enum):
        FEMALE = enum.auto()
        MALE = enum.auto()

    id = Column(Integer, primary_key=True, nullable=False)
    email = Column(VARCHAR(length=255), nullable=False)
    gender = Column('gender', IntEnum(Gender))
    ...
```

Migration example with alembic how to load the application configuration, please.

### Data Access Layer

The `DataAccess` layer is the facade of the data layer, consisting of `API` functions that will access our data sources, such as database connections and entities.

#### Responsibilities: 

1. Expose the Product data API. 
2. Optimization and speed.
3. Caching

```python
class UserDataAccess(DataAccess):

    def __init__(self, db_session: SqlAlchemyConnectionRegistry):
        self.db_session = db_session

    def get(self, id: int):
        with self.db_session.get() as session:
            return session.Query(User).get(id)
```

### Service Layer

The `Service` layer is a facade of the `DataAccess` layer and connections. consisting of `API` functions that will handle business logic, data transformation, and caching.
#### Responsibilities: 

1. Business Logic
2. Transform all get data into `dict`
3. Caching

```python
from core_lib.data_transform.result_to_dict import ResultToDict
from core_lib.data_layers.service.service import Service

class UserService(Service):

    def __init__(self, user_data_access: UserDataAccess, user_friends_data_acccess: UserFriendsDataAccess):
        self.user_data_access = user_data_access
        self.user_friends_data_acccess = user_friends_data_acccess

    @ResultToDict # Transform data to dict. 
    def get(self, user_id: int):
        user = self.user_data_access.get(user_id)
        if user.something:
            user.friends = self.user_friends_data_acccess.get_user_friends(user_id)
        return user
```


   

## Sample Application

Sample applications can be found here 